(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/zhiyuanshizhang/add-or-update"],{"8caa":function(n,e,a){},bffe:function(n,e,a){"use strict";a.r(e);var t=a("d259"),r=a.n(t);for(var u in t)"default"!==u&&function(n){a.d(e,n,(function(){return t[n]}))}(u);e["default"]=r.a},d1e4:function(n,e,a){"use strict";var t;a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return u})),a.d(e,"a",(function(){return t}));var r=function(){var n=this,e=n.$createElement;n._self._c},u=[]},d259:function(n,e,a){"use strict";(function(n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=r(a("a34a"));function r(n){return n&&n.__esModule?n:{default:n}}function u(n,e,a,t,r,u,o){try{var i=n[u](o),s=i.value}catch(h){return void a(h)}i.done?e(s):Promise.resolve(s).then(t,r)}function o(n){return function(){var e=this,a=arguments;return new Promise((function(t,r){var o=n.apply(e,a);function i(n){u(o,t,r,i,s,"next",n)}function s(n){u(o,t,r,i,s,"throw",n)}i(void 0)}))}}var i=function(){Promise.all([a.e("common/vendor"),a.e("components/w-picker/w-picker")]).then(function(){return resolve(a("bcaf"))}.bind(null,a)).catch(a.oe)},s={data:function(){return{cross:"",ruleForm:{huodongbianhao:"",huodongmingcheng:"",zhiyuanshizhang:"",huodongtupian:"",zhiyuanzhezhanghao:"",zhiyuanzhexingming:"",userid:""},huodongbianhaoOptions:[],huodongbianhaoIndex:0,user:{},ro:{huodongbianhao:!1,huodongmingcheng:!1,zhiyuanshizhang:!1,huodongtupian:!1,zhiyuanzhezhanghao:!1,zhiyuanzhexingming:!1,userid:!1}}},components:{wPicker:i},computed:{baseUrl:function(){return this.$base.url}},onLoad:function(e){var a=this;return o(t.default.mark((function r(){var u,o,i,s;return t.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return u=n.getStorageSync("nowTable"),r.next=3,a.$api.session(u);case 3:return o=r.sent,a.user=o.data,r.next=7,a.$api.option("zhiyuanhuodong","huodongbianhao",{});case 7:if(o=r.sent,a.huodongbianhaoOptions=o.data,a.ruleForm.userid=n.getStorageSync("userid"),e.refid&&(a.ruleForm.refid=e.refid,a.ruleForm.nickname=n.getStorageSync("nickname")),!e.id){r.next=17;break}return a.ruleForm.id=e.id,r.next=15,a.$api.info("zhiyuanshizhang",a.ruleForm.id);case 15:o=r.sent,a.ruleForm=o.data;case 17:if(a.cross=e.cross,!e.cross){r.next=55;break}i=n.getStorageSync("crossObj"),r.t0=t.default.keys(i);case 21:if((r.t1=r.t0()).done){r.next=53;break}if(s=r.t1.value,"huodongbianhao"!=s){r.next=27;break}return a.ruleForm.huodongbianhao=i[s],a.ro.huodongbianhao=!0,r.abrupt("continue",21);case 27:if("huodongmingcheng"!=s){r.next=31;break}return a.ruleForm.huodongmingcheng=i[s],a.ro.huodongmingcheng=!0,r.abrupt("continue",21);case 31:if("zhiyuanshizhang"!=s){r.next=35;break}return a.ruleForm.zhiyuanshizhang=i[s],a.ro.zhiyuanshizhang=!0,r.abrupt("continue",21);case 35:if("huodongtupian"!=s){r.next=39;break}return a.ruleForm.huodongtupian=i[s],a.ro.huodongtupian=!0,r.abrupt("continue",21);case 39:if("zhiyuanzhezhanghao"!=s){r.next=43;break}return a.ruleForm.zhiyuanzhezhanghao=i[s],a.ro.zhiyuanzhezhanghao=!0,r.abrupt("continue",21);case 43:if("zhiyuanzhexingming"!=s){r.next=47;break}return a.ruleForm.zhiyuanzhexingming=i[s],a.ro.zhiyuanzhexingming=!0,r.abrupt("continue",21);case 47:if("userid"!=s){r.next=51;break}return a.ruleForm.userid=i[s],a.ro.userid=!0,r.abrupt("continue",21);case 51:r.next=21;break;case 53:a.ruleForm.zhiyuanshizhang=0,a.ro.zhiyuanshizhang=!1;case 55:a.styleChange();case 56:case"end":return r.stop()}}),r)})))()},methods:{styleChange:function(){this.$nextTick((function(){}))},huodongbianhaoChange:function(n){var e=this;return o(t.default.mark((function a(){var r;return t.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.huodongbianhaoIndex=n.target.value,e.ruleForm.huodongbianhao=e.huodongbianhaoOptions[e.huodongbianhaoIndex],a.next=4,e.$api.follow("zhiyuanhuodong","huodongbianhao",{columnValue:e.ruleForm.huodongbianhao});case 4:r=a.sent,r.data.huodongmingcheng&&(e.ruleForm.huodongmingcheng=r.data.huodongmingcheng),r.data.zhiyuanshizhang&&(e.ruleForm.zhiyuanshizhang=r.data.zhiyuanshizhang);case 7:case"end":return a.stop()}}),a)})))()},huodongtupianTap:function(){var n=this;this.$api.upload((function(e){n.ruleForm.huodongtupian="upload/"+e.file,n.$forceUpdate(),n.$nextTick((function(){n.styleChange()}))}))},getUUID:function(){return(new Date).getTime()},onSubmitTap:function(){var e=this;return o(t.default.mark((function a(){var r,u,o,i,s,h,c,g,d,l;return t.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!e.ruleForm.zhiyuanshizhang||e.$validate.isIntNumer(e.ruleForm.zhiyuanshizhang)){a.next=3;break}return e.$utils.msg("志愿时长应输入整数"),a.abrupt("return");case 3:if(!e.cross){a.next=19;break}if(i=n.getStorageSync("statusColumnName"),s=n.getStorageSync("statusColumnValue"),""==i){a.next=19;break}if(h=n.getStorageSync("crossObj"),i.startsWith("[")){a.next=15;break}for(c in h)c==i&&(h[c]=s);return g=n.getStorageSync("crossTable"),a.next=13,e.$api.update("".concat(g),h);case 13:a.next=19;break;case 15:r=Number(n.getStorageSync("userid")),u=h["id"],o=n.getStorageSync("statusColumnName"),o=o.replace(/\[/,"").replace(/\]/,"");case 19:if(!u||!r){a.next=46;break}return e.ruleForm.crossuserid=r,e.ruleForm.crossrefid=u,d={page:1,limit:10,crossuserid:r,crossrefid:u},a.next=25,e.$api.list("zhiyuanshizhang",d);case 25:if(l=a.sent,!(l.data.total>=o)){a.next=31;break}return e.$utils.msg(n.getStorageSync("tips")),a.abrupt("return",!1);case 31:return h=n.getStorageSync("crossObj"),g=n.getStorageSync("crossTable"),h.zhiyuanshizhang=parseFloat(h.zhiyuanshizhang)+parseFloat(e.ruleForm.zhiyuanshizhang),a.next=36,e.$api.update("".concat(g),h);case 36:if(!e.ruleForm.id){a.next=41;break}return a.next=39,e.$api.update("zhiyuanshizhang",e.ruleForm);case 39:a.next=43;break;case 41:return a.next=43,e.$api.add("zhiyuanshizhang",e.ruleForm);case 43:e.$utils.msgBack("提交成功");case 44:a.next=59;break;case 46:return h=n.getStorageSync("crossObj"),g=n.getStorageSync("crossTable"),h.zhiyuanshizhang=parseFloat(h.zhiyuanshizhang)+parseFloat(e.ruleForm.zhiyuanshizhang),a.next=51,e.$api.update("".concat(g),h);case 51:if(!e.ruleForm.id){a.next=56;break}return a.next=54,e.$api.update("zhiyuanshizhang",e.ruleForm);case 54:a.next=58;break;case 56:return a.next=58,e.$api.add("zhiyuanshizhang",e.ruleForm);case 58:e.$utils.msgBack("提交成功");case 59:case"end":return a.stop()}}),a)})))()},optionsChange:function(n){this.index=n.target.value},bindDateChange:function(n){this.date=n.target.value},getDate:function(n){var e=new Date,a=e.getFullYear(),t=e.getMonth()+1,r=e.getDate();return"start"===n?a-=60:"end"===n&&(a+=2),t=t>9?t:"0"+t,r=r>9?r:"0"+r,"".concat(a,"-").concat(t,"-").concat(r)},toggleTab:function(n){this.$refs[n].show()}}};e.default=s}).call(this,a("543d")["default"])},ebef:function(n,e,a){"use strict";var t=a("8caa"),r=a.n(t);r.a},f40c:function(n,e,a){"use strict";a.r(e);var t=a("d1e4"),r=a("bffe");for(var u in r)"default"!==u&&function(n){a.d(e,n,(function(){return r[n]}))}(u);a("ebef");var o,i=a("f0c5"),s=Object(i["a"])(r["default"],t["b"],t["c"],!1,null,"6f8f86d2",null,!1,t["a"],o);e["default"]=s.exports},fe79:function(n,e,a){"use strict";(function(n){a("38c9");t(a("66fd"));var e=t(a("f40c"));function t(n){return n&&n.__esModule?n:{default:n}}n(e.default)}).call(this,a("543d")["createPage"])}},[["fe79","common/runtime","common/vendor"]]]);